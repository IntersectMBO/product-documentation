---
description: 'Updated: 19 Aug 2024'
---

# In draft

{% hint style="info" %}
This page is written on behalf of the Core Infrastructure Roadmap working group, the information contained is subject to change and amendment by the working group at any time.
{% endhint %}

## LSM-2. Increase Capability to store UTxOs on disk using LSM (Integration to Node)

{% hint style="info" %}
This is a follow-up work from current inflight item [LSM-1](../current-state/list-of-inflight-items.md#id-2.-increase-capability-to-store-utxos-on-disk-using-lsm-pre-contracted)
{% endhint %}

With continued growth of the Cardano Blockchain Ledger, the need to move from an in-memory to a disk persisted solution is even more important. This achieves more scalability and assures SPOs and full node wallets of being able to operate on commodity hardware or retain a lower footprint on cloud . Implementation of LSM will use an innovative approach to persisting to disk (SSD) using a Log Structured Merge(LSM) tree, which will be built standalone and integrated in node.

The component will take the form of a Haskell library for managing tables of key-value data stored persistently on disk. This is to reduce the memory size of the UTXO set (ledger) that will allow us to potentially quadruple the transactions on the network without increasing memory cost, which is hugely beneficial to Stake Pool Operators. This is intended to be used later within the Cardano node for storing large parts of the ledger state on disk. The component is specified as a “stand alone” component, in isolation from Cardano, with detailed functional and non-functional requirements. The work is structured in such a way that after an initial design phase further ratification and community feedback will be sought prior to any implementation or production deployment.

<table data-header-hidden><thead><tr><th width="249"></th><th></th></tr></thead><tbody><tr><td>Status</td><td>In draft<br>This item is pending validation of business benefits. A SIG is being set up to gather community input to articulate its value. </td></tr><tr><td>Drivers</td><td><ol><li>Performance - reducing the memory size of the ledger allows us to improve transactions on the network. Ensure long term scalability for Cardano, by fixing a limit on the total memory requirement for the node.</li><li>Ensure all ledger state is held in non-volatile storage</li></ol></td></tr><tr><td>Documentation</td><td>Whitepaper Link:<a href="https://drive.google.com/file/d/1XkY7CKNM9DoL4c8rbnAKUH6s9PUrJ5oH/view?usp=drive_link"> https://drive.google.com/file/d/1XkY7CKNM9DoL4c8rbnAKUH6s9PUrJ5oH/view?usp=drive_link</a></td></tr><tr><td>Target State</td><td>Developed new Log Structured Merge Tree implementations on Cardano mainnet</td></tr><tr><td>Definition of Done</td><td>LSM work integrated into mainnet</td></tr><tr><td>Product Stage</td><td>Integration</td></tr><tr><td>Functional Requirements</td><td>LSM work integrated into the node providing an in-memory backend and an on-disk backend that can be toggled via config and/or runtime flags</td></tr><tr><td>Non-functional Requirements</td><td>TBC</td></tr><tr><td>External Dependencies</td><td>Completion of LSM libraries by Well-Typed</td></tr><tr><td>Communication Channel</td><td><p>Intersect Development Updates</p><p>Intersect Knowledge Base</p></td></tr><tr><td>Indicative Sizing</td><td>L (Will be several months of work)</td></tr><tr><td>Context of Indicative Sizing</td><td>Much of consensus needs to be adapted to use the LSM libraries for reading/writing states from/to disk</td></tr><tr><td>Dependencies &#x26; Dependants</td><td>TBC</td></tr><tr><td>Hardfork (Yes,No, TBC)</td><td>Not required</td></tr><tr><td>Security Review</td><td>Yes</td></tr><tr><td>Code Audit</td><td>Part of Node audit</td></tr><tr><td>Community Endorsement</td><td>TBC</td></tr><tr><td>Feasibility Study Required?</td><td>No</td></tr><tr><td>Reviewing Working Group</td><td>Ledger working group (Also involved Consensus &#x26; CLI)</td></tr><tr><td>Core Infrastructure (Yes, No, TBC)</td><td>Yes</td></tr><tr><td>Item Champion</td><td>IOE</td></tr></tbody></table>

## OBL-1. Ouroboros Leios

Ouroboros Leios is a novel protocol extending Ouroboros Praos that aims at dramatically increasing the throughput of Cardano network. Leios is based on the key idea of input endorsers. Whereas in a classical blockchain, the blocks' body directly contains transactions, in Leios the blocks' body can also contain references to Endorser blocks which themselves contain references to so-called Input blocks containing the actual transactions. Those references are certified through a voting mechanism that guarantees a majority of validators agree on the content of Endorser blocks. By decoupling the logic of validating blocks' payload and extending the blockchain, and limiting the work needed to verify the chain, much higher throughput can be achieved and new use cases can be unlocked.

Simulating Leios is a critical precursor to subsequently implementing it because Leios aims to make full use of network bandwidth in a heterogeneous environment where input blocks, endorser blocks, votes, certificates are diffused in addition to the ordinary Ouroboros Praos traffic. Simulation will provide detailed statistics on Leios performance under normal conditions, during congestion, and in the face of adversarial activity. Formal methods are required to verify that the network simulations are faithful to the Leios protocol.

<table data-header-hidden><thead><tr><th width="257"></th><th></th></tr></thead><tbody><tr><td>Status</td><td>In draft<br>This item is pending validation of business benefits. A SIG is being set up to gather community input to articulate its value. </td></tr><tr><td>Drivers</td><td>Scalability</td></tr><tr><td>Documentation</td><td>Research paper<a href="https://iohk.io/en/research/library/papers/high-throughput-blockchain-consensus-under-realistic-network-assumptions/"> High-Throughput Blockchain Consensus under Realistic Network Assumptions</a> and repository<a href="https://github.com/input-output-hk/ouroboros-leios"> github:/input-output-hk/ouroboros-leios</a> and web site<a href="https://leios.cardano-scaling.org/"> https://leios.cardano-scaling.org/</a> Youtube explainer:<a href="https://www.youtube.com/watch?v=Czmg9WmSCcI"> Scaling Blockchain Protocols</a></td></tr><tr><td>Target State</td><td>Prototyping Simulations, Formal specs</td></tr><tr><td>Definition of Done</td><td>Publish simulations, their source code, visualizations, and specifications for community and stakeholder use</td></tr><tr><td>Product Stage</td><td>Currently at SRL2 (Target to get to SRL5)</td></tr><tr><td>Functional Requirements</td><td>Implement multi-node simulations that are formally verified to be faithful to the Leios protocol; develop analysis and visualization tools to quantify Leios behavior and performance.</td></tr><tr><td>Non-functional Requirements</td><td>Simulations can be used interactively by the stakeholder community to study Leios.</td></tr><tr><td>External Dependencies</td><td>TBC</td></tr><tr><td>Communication Channel</td><td>Website, Github repository, Discord channel, video</td></tr><tr><td>Indicative Sizing</td><td>2L</td></tr><tr><td>Context of Indicative Sizing</td><td>Six months of 5 FTEs (1x Architect, 1x Formal Methods Engineer, 2x prototyping engineers, 0.5x Researcher, 0.5x Product Owner)</td></tr><tr><td>Dependencies &#x26; Dependant</td><td>TBC</td></tr><tr><td>Hardfork (Yes,No, TBC)</td><td>Not for this proof of concept</td></tr><tr><td>Security Review</td><td>N/A</td></tr><tr><td>Code Audit</td><td>N/A</td></tr><tr><td>Community Endorsement</td><td>Yes</td></tr><tr><td>Feasibility Study Required?</td><td>Yes</td></tr><tr><td>Reviewing Working Group</td><td>Consensus, Networking</td></tr><tr><td>Core Infrastructure (Yes, No, TBC)</td><td>Yes</td></tr><tr><td>Item Champion</td><td>IOR</td></tr><tr><td>Talking Points (Optional)</td><td><p>- Prerequisite to implementing Leios</p><p>- Builds engineering and business cases for Leios</p><p>- Lays groundwork for detailed formal specification of Leios in a (revised) CIP</p></td></tr></tbody></table>

## OBP-1. Ouroboros Peras

Ouroboros Peras modifies the chain-selection rule to include the "boosting" of the dominant chain's blocks by a quorum of votes from periodic randomly-selected voting committees. It reduces the settlement time by orders of magnitude without weakening the existing security guarantees. It is compatible with and orthogonal to Leios and Genesis, and it only has a very minor impact on the resource consumption of block-producing nodes. It requires modification of the chain-selection rule, a small change the the CDDL of the block body, and the creation, transport, and verification of votes and the certificates that witness a quorum of votes. It adds several new protocol parameters.

Peras has synergies with Leios and other proposals that involve voting, certificates, or transport/storage of additional data beyond what Praos and Genesis already handle. The Peras task involves (a) implementing this protocol in the Haskell-based Cardano node, (b) providing node-oriented conformance tests (which are distinct from the already existing protocol-level conformance tests) so that non-Haskell nodes (in Rust, Go, etc.) can be verified, and (c) updating the relevant node documentation and specifications.

One of the key benefits is Peras will dramatically shorten the "settlement" or "finality" time for transactions, providing near-certainty within a couple of minutes regarding whether a block will forever remain on the main chain.

<table data-header-hidden><thead><tr><th width="248"></th><th></th></tr></thead><tbody><tr><td>Status</td><td>In draft<br>This item is pending validation of business benefits. A SIG is being set up to gather community input to articulate its value. </td></tr><tr><td>Drivers</td><td>Adoption</td></tr><tr><td>Documentation</td><td><a href="https://peras-staging.cardano-scaling.org/">https://peras-staging.cardano-scaling.org</a> (soon to become<a href="https://peras.cardano-scaling.org/"> https://peras.cardano-scaling.org/</a>),<a href="https://github.com/input-output-hk/peras-design"> https://github.com/input-output-hk/peras-design</a>, and draft CIP to be submitted early August</td></tr><tr><td>Target State</td><td>Production</td></tr><tr><td>Definition of Done</td><td>Implementation + audit + testnet + hard fork</td></tr><tr><td>Product Stage</td><td>Currently at SRL 4 (prototyping, specification, formalization, and conformance testing already completed)</td></tr><tr><td>Service Level</td><td>BRL 2</td></tr><tr><td>Functional Requirements</td><td>Implement Peras protocol (described in CIP and research paper) in the Haskell-based Cardano node.</td></tr><tr><td>Non-functional Requirements</td><td>Implement a comprehensive, node-level conformance test suite usable by nodes written in any programming language; update node specifications and CDDL; benchmark node network usage to ensure that it increased by less than 20% due to Peras vote and certificate transport.</td></tr><tr><td>External Dependencies</td><td>Coordination and architectural coherence with work on other node developments such as Genesis, Leios, and Mithril.</td></tr><tr><td>Communication Channel</td><td>Web site, Discord channel, YouTube video, GitHub repository, blog posts</td></tr><tr><td>Indicative Sizing</td><td>2L</td></tr><tr><td>Context of Indicative Sizing</td><td>The development, testing, and documentation effort is approximately two person-years. (This estimate does not include ancillary activities like testnet operation.) However, there may be synergies with other items such as Leios, and leveraging those could reduce the combined level of effort.</td></tr><tr><td>Dependencies &#x26; Dependant</td><td>TBC</td></tr><tr><td>Hardfork (Yes,No, TBC)</td><td>Yes</td></tr><tr><td>Security Review</td><td>Yes</td></tr><tr><td>Code Audit</td><td>Yes</td></tr><tr><td>Community Endorsement</td><td>Yes</td></tr><tr><td>Feasibility Study Required?</td><td>No</td></tr><tr><td>Reviewing Working Group</td><td>Consensus</td></tr><tr><td>Core Infrastructure (Yes, No, TBC)</td><td>Yes</td></tr><tr><td>Item Champion</td><td>IOR</td></tr><tr><td>Talking Points (Optional)</td><td><p>- High benefit (fast settlement) at low develoment cost and without compromises to security</p><p>- Synergies with Leios, Mithril, and Genesis</p><p>- Enables fast interoperability with partner chains and bridges</p></td></tr></tbody></table>

\
\
\
